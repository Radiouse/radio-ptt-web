<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Food Barcode Scanner | Public Utility</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  min-height:100vh;
  background:radial-gradient(circle at top,#0b5ed7 0%,#020617 65%);
  font-family:Segoe UI,Arial;
  color:#fff;
  display:flex;
  align-items:center;
  justify-content:center;
}
.card{
  width:480px;
  max-width:96%;
  background:rgba(255,255,255,.1);
  backdrop-filter:blur(18px);
  border-radius:24px;
  padding:24px;
  box-shadow:0 40px 80px rgba(0,0,0,.7);
}
h2{text-align:center;margin:0}
input,button{
  width:100%;
  margin-top:14px;
  padding:14px;
  border:none;
  border-radius:14px;
  font-size:15px;
}
input{background:#020617;color:#fff}
button{
  background:#0b5ed7;
  color:#fff;
  font-weight:600;
  cursor:pointer;
}
.section{
  margin-top:14px;
  padding:12px;
  border-radius:14px;
  background:#020617;
  font-size:14px;
}
.good{color:#4ade80}
.warn{color:#facc15}
.bad{color:#f87171}
.small{font-size:12px;opacity:.7}
</style>
</head>

<body>

<div class="card">
  <h2>üçé Food Barcode Scanner</h2>
  <p class="small" style="text-align:center">
    Nutrition ‚Ä¢ Health ‚Ä¢ Kids Safety ‚Ä¢ India Friendly
  </p>

  <!-- BARCODE INPUT -->
  <input id="barcode" placeholder="Enter / Scan Barcode (e.g. 8901030870060)">
  <button onclick="processBarcode()">üîç Check Food</button>

  <!-- RESULT -->
  <div id="result"></div>
</div>

<script>
function processBarcode(code){
  const barcode = code || document.getElementById("barcode").value.trim();
  if(!barcode){
    alert("Enter barcode");
    return;
  }

  const result = document.getElementById("result");
  result.innerHTML = "‚è≥ Fetching product details‚Ä¶";

  fetch(`https://world.openfoodfacts.org/api/v2/product/${barcode}.json`)
  .then(r=>r.json())
  .then(d=>{
    if(!d.product){
      result.innerHTML = "<span class='bad'>‚ùå Product not found</span>";
      return;
    }

    const p = d.product;

    /* ===== SCORES ===== */
    const nutri = (p.nutriscore_grade || "N/A").toUpperCase();
    const nova  = p.nova_group || "N/A";
    const green = (p.ecoscore_grade || "N/A").toUpperCase();

    const nutriText = {
      A:"üü¢ Very good nutrition",
      B:"üü° Good nutrition",
      C:"üü† Moderate nutrition",
      D:"üî¥ Poor nutrition",
      E:"üî¥ Very poor nutrition"
    }[nutri] || "Not available";

    const novaText = {
      1:"üü¢ Unprocessed / natural",
      2:"üü° Processed ingredients",
      3:"üü† Processed food",
      4:"üî¥ Ultra-processed food"
    }[nova] || "Not available";

    /* ===== NUTRIENTS ===== */
    const sugar = p.nutriments?.sugars_100g || 0;
    const salt  = p.nutriments?.salt_100g || 0;
    const fat   = p.nutriments?.saturated_fat_100g || 0;

    let alerts = "";
    if(sugar > 10) alerts += "‚ö†Ô∏è High sugar<br>";
    if(salt > 1.25) alerts += "‚ö†Ô∏è High salt<br>";
    if(fat > 5) alerts += "‚ö†Ô∏è High saturated fat<br>";
    if(!alerts) alerts = "‚úÖ No major risk nutrients";

    /* ===== VERDICT ===== */
    let verdict = "‚ö†Ô∏è Consume in moderation";
    let verdictHi = "‚ö†Ô∏è ‡§∏‡•Ä‡§Æ‡§ø‡§§ ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ ‡§Æ‡•á‡§Ç ‡§≤‡•á‡§Ç";

    if(["A","B"].includes(nutri) && nova <= 2){
      verdict = "‚úÖ Healthy choice";
      verdictHi = "‚úÖ ‡§∏‡•ç‡§µ‡§∏‡•ç‡§• ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™";
    }
    if(["D","E"].includes(nutri) || nova == 4){
      verdict = "‚ùå Avoid frequent use";
      verdictHi = "‚ùå ‡§¨‡§æ‡§∞-‡§¨‡§æ‡§∞ ‡§® ‡§≤‡•á‡§Ç";
    }

    /* ===== KIDS SAFETY ===== */
    let kids = "‚úÖ Suitable for children";
    if(sugar > 8 || nova == 4){
      kids = "‚ùå Not recommended for children";
    }

    /* ===== ALLERGENS ===== */
    const allergens = p.allergens
      ? "‚ö†Ô∏è Allergens: " + p.allergens.replace(/en:/g,"")
      : "‚úÖ No major allergens listed";

    /* ===== DISPLAY ===== */
    result.innerHTML = `
      <div class="section">
        <strong>ü•ó Nutri-Score ${nutri}</strong><br>${nutriText}
      </div>

      <div class="section">
        <strong>üè≠ NOVA Group ${nova}</strong><br>${novaText}
      </div>

      <div class="section">
        <strong>üå± Green-Score</strong><br>
        ${green === "N/A" ? "Not applicable" : "Green-Score " + green}
      </div>

      <div class="section warn">
        <strong>‚ö†Ô∏è Health Alerts</strong><br>${alerts}
      </div>

      <div class="section">
        <strong>ü§ñ Verdict</strong><br>
        ${verdict}<br>
        <span class="small">${verdictHi}</span>
      </div>

      <div class="section">
        <strong>üë∂ Kids Safety</strong><br>${kids}
      </div>

      <div class="section">
        <strong>üß™ Allergens</strong><br>${allergens}
      </div>
    `;
  })
  .catch(()=>{
    result.innerHTML = "<span class='bad'>‚ùå Error fetching data</span>";
  });
}
</script>

</body>
</html>
